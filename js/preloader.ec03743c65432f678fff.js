"use strict";(self.webpackChunkyvelious_github_io=self.webpackChunkyvelious_github_io||[]).push([[523],{985:(e,t,a)=>{a.d(t,{Zw:()=>h}),new class{constructor(){this.startTime=performance.now(),this.totalImageSize=0,this.loadedImageUrls=new Set,this.imageLoadTimes={},this.enabled=!0,this.trackedUrls=new Set,this.init()}init(){this.enabled}registerTrackedImage(e){if(!this.enabled)return;const t=this._normalizeUrl(e);this.trackedUrls.add(t),1===this.trackedUrls.size&&this._setupImageObserver()}isTrackedUrl(e){if(!this.enabled)return!1;const t=this._normalizeUrl(e);return this.trackedUrls.has(t)}_normalizeUrl(e){try{const t=new URL(e,window.location.href);return t.origin+t.pathname+t.search}catch{return e}}_setupImageObserver(){window.PerformanceObserver&&new PerformanceObserver(e=>{e.getEntries().forEach(e=>{("img"===e.initiatorType||e.name.match(/\.(jpg|jpeg|png|webp|gif|svg)($|\?)/i))&&this.isTrackedUrl(e.name)&&this.trackResource(e)})}).observe({entryTypes:["resource"]})}trackImageStart(e){this.enabled&&(this.registerTrackedImage(e),this.imageLoadTimes[e]||(this.imageLoadTimes[e]={}),this.imageLoadTimes[e].start=performance.now())}trackImageEnd(e){this.enabled&&this.isTrackedUrl(e)&&(this.imageLoadTimes[e]||(this.imageLoadTimes[e]={}),this.imageLoadTimes[e].end=performance.now(),this.updateImageStats(e))}trackResource(e){this.enabled&&this.isTrackedUrl(e.name)&&(this.loadedImageUrls.has(e.name)||this.updateImageStats(e.name,"auto",{size:e.transferSize||e.encodedBodySize||0,loadTime:e.duration}))}async updateImageStats(e,t="unknown",a=null){if(!this.enabled)return;if(this.loadedImageUrls.has(e))return;if(!this.isTrackedUrl(e))return;this.loadedImageUrls.add(e);let r=a;r||(r=await this.getImageStatsAccurate(e));const n=r.size,o=r.loadTime;this.totalImageSize+=n,console.log(` Image loaded [${t}]: ${this._getShortUrl(e)}`),console.log(`   Size: ${(n/1024).toFixed(2)} KB`),console.log(`   Load time: ${o.toFixed(2)} ms`),console.log(`   Total size so far: ${(this.totalImageSize/1024).toFixed(2)} KB`)}async getImageStatsAccurate(e){let t=this._getImageSize(e),a=this._getImageLoadTime(e);if(0===t){const r=await this._getImageSizeWithFetch(e);t=r.size,0===a&&(a=r.time)}return 0===a&&this.imageLoadTimes[e]&&(a=this.imageLoadTimes[e].end-this.imageLoadTimes[e].start),{size:t,loadTime:a}}_getImageSize(e){const t=performance.getEntriesByName(e);if(t.length>0){const e=t[t.length-1];return e.transferSize||e.encodedBodySize||0}return 0}_getImageLoadTime(e){const t=performance.getEntriesByName(e);return t.length>0&&t[t.length-1].duration||0}async _getImageSizeWithFetch(e){const t=performance.now();try{const a=await fetch(e,{method:"HEAD"}),r=performance.now(),n=a.headers.get("content-length");return{size:n?parseInt(n,10):0,time:r-t}}catch(t){return console.warn(`Could not get size for ${e}:`,t),{size:0,time:0}}}_getShortUrl(e){try{const t=new URL(e);return t.pathname.split("/").pop()+(t.search||"")}catch{return e}}markEvent(e){if(!this.enabled)return;const t=performance.now()-this.startTime;console.log(`⏱️ ${e}: ${t.toFixed(2)} ms`)}printTrackedUrls(){this.enabled&&(console.log(""),console.log(" TRACKED URLS:"),Array.from(this.trackedUrls).forEach((e,t)=>{console.log(`   ${t+1}. ${e}`)}),console.log(""))}printSummary(){if(!this.enabled)return;const e=performance.now()-this.startTime,t=this.loadedImageUrls.size,a=this.trackedUrls.size;console.log(""),console.log(" PRELOADER DEBUG SUMMARY:"),console.log(`   Tracked images: ${a}`),console.log(`   Successfully loaded: ${t} (${Math.round(t/a*100)}% of tracked)`),console.log(`   Total size: ${(this.totalImageSize/1024).toFixed(2)} KB (${(this.totalImageSize/1024/1024).toFixed(2)} MB)`),console.log(`   Total time: ${e.toFixed(2)} ms (${(e/1e3).toFixed(2)} sec)`),console.log("")}};const r={markEvent:()=>{},trackImageStart:()=>{},trackImageEnd:()=>{},printSummary:()=>{}},n=Boolean(globalThis.__TEST_TRACK_BACKGROUNDS)||!1;let o=1,s=0,i=!1,c=-1,l=0,d=0;const m=(()=>{let e=null;return()=>e||(e=document.querySelector(".preloader"))})(),u=(()=>{let e=null;return()=>e||(e=document.querySelector(".preloader__bar"))})();function g(){s=Math.min(s+1,o);const e=Math.round(s/o*100),t=u();t&&t.value!==e&&(t.value=e),function(e){e!==c&&(l=e,d||(d="undefined"!=typeof requestAnimationFrame?requestAnimationFrame(()=>{const e=m();e&&(e.dataset.value=String(l),c=l),d=0}):setTimeout(()=>{const e=m();e&&(e.dataset.value=String(l),c=l),d=0},0)))}(e),r.markEvent(`Progress: ${s}/${o} (${e}%)`),s>=o&&(r.markEvent("Loading complete"),function(){const e=m();if(!e)return;r.markEvent("Started fade animation"),e.classList.add("preloader--hidden");const t=a=>{"opacity"===a.propertyName&&(e.style.display="none",e.removeEventListener("transitionend",t),r.markEvent("Preloader hidden"),r.printSummary())};e.addEventListener("transitionend",t),e.addEventListener("transitioncancel",t,{once:!0}),window.dataLayer?.push({event:"allow_ga4"})}())}function h(e=1){i||(function(){const e=m();if(!e)return;e.classList.remove("preloader--hidden"),e.style.display="",e.dataset.value="0";const t=u();if(t&&(t.value=0),s=0,c=-1,d){if("undefined"!=typeof cancelAnimationFrame&&"number"==typeof d)try{cancelAnimationFrame(d)}catch(e){clearTimeout(d)}else clearTimeout(d);d=0}}(),o=e,g(),1===o&&(i=!0))}function f(){if(!m())return void console.warn("[preloader] .preloader not found");const e=()=>{!function(){const e=document.getElementById("critical-css"),t=new Set,a=Array.from(document.images).filter(e=>{const t=e.getBoundingClientRect();return t.bottom>0&&t.top<innerHeight});if(n){let a=null;try{a=e&&e.sheet}catch(e){console.warn("[preloader] critical-css access error:",e),a=null}if(a)try{for(const e of a.cssRules)if(e.style?.backgroundImage?.includes("url(")){const a=e.style.backgroundImage.match(/url\(["']?([^"')]+)["']?\)/)?.[1];if(a){const r=document.querySelectorAll(e.selectorText);for(const e of r){const r=e.getBoundingClientRect();r.bottom>0&&r.top<innerHeight&&t.add(a)}}}}catch(e){console.warn("[preloader] critical-css parse error:",e)}}o=a.length+t.size+1,s=0,r.markEvent(`Detected: ${o} resources`),a.forEach(e=>{r.trackImageStart(e.src);const t=()=>{r.trackImageEnd(e.src),g()};e.complete?t():e.onload=e.onerror=t}),t.forEach(e=>{const t=new Image;r.trackImageStart(e),t.onload=t.onerror=()=>{r.trackImageEnd(e),g()},t.src=e}),document.fonts?.ready?.then(()=>{r.markEvent("Fonts ready"),g()})??g()}()};if("undefined"!=typeof requestIdleCallback)try{requestIdleCallback(e,{timeout:150})}catch(t){setTimeout(e,0)}else if("undefined"!=typeof queueMicrotask)try{queueMicrotask(e)}catch(t){setTimeout(e,0)}else setTimeout(e,0)}!function(){if("loading"!==document.readyState)return void f();const e=()=>{document.removeEventListener("DOMContentLoaded",e),f()};document.addEventListener("DOMContentLoaded",e)}()}},e=>{e(e.s=985)}]);